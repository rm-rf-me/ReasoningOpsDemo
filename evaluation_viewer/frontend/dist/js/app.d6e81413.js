(function(){"use strict";var e={3755:function(e,t,l){var a=l(3751),s=l(2899),i=l(1029),r=l(641),n=l(33);const o={class:"home"},c={key:0,class:"stats-overview"},d={key:1,class:"alarm-content"},u={style:{"font-size":"12px",color:"#1890ff",display:"inline-block","max-width":"100%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},p={style:{"font-size":"12px",color:"#666",display:"inline-block","max-width":"100%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}};function h(e,t,l,a,s,i){const h=(0,r.g2)("a-statistic"),g=(0,r.g2)("a-col"),f=(0,r.g2)("a-row"),m=(0,r.g2)("SearchOutlined"),b=(0,r.g2)("a-input"),x=(0,r.g2)("a-form-item"),y=(0,r.g2)("a-select-option"),_=(0,r.g2)("a-select"),v=(0,r.g2)("a-button"),k=(0,r.g2)("a-form"),F=(0,r.g2)("a-card"),E=(0,r.g2)("a-typography-text"),L=(0,r.g2)("a-tag"),w=(0,r.g2)("a-tooltip"),C=(0,r.g2)("a-table"),S=(0,r.g2)("UploadOutlined"),T=(0,r.g2)("a-empty");return(0,r.uX)(),(0,r.CE)("div",o,[e.stats?((0,r.uX)(),(0,r.CE)("div",c,[(0,r.bF)(f,{gutter:16},{default:(0,r.k6)(()=>[(0,r.bF)(g,{span:6},{default:(0,r.k6)(()=>[(0,r.bF)(h,{title:"æ€»æ ·æœ¬æ•°",value:e.stats.total_results},null,8,["value"])]),_:1}),(0,r.bF)(g,{span:6},{default:(0,r.k6)(()=>[(0,r.bF)(h,{title:"å‡†ç¡®ç‡",value:100*e.stats.accuracy,suffix:"%",precision:2},null,8,["value"])]),_:1}),(0,r.bF)(g,{span:6},{default:(0,r.k6)(()=>[(0,r.bF)(h,{title:"F1åˆ†æ•°",value:100*e.stats.f1_score,suffix:"%",precision:2},null,8,["value"])]),_:1}),(0,r.bF)(g,{span:6},{default:(0,r.k6)(()=>[(0,r.bF)(h,{title:"è§£æå¤±è´¥",value:e.stats.parse_failures},null,8,["value"])]),_:1})]),_:1})])):(0,r.Q3)("",!0),(0,r.bF)(F,{class:"filter-panel",title:"ç­›é€‰æ¡ä»¶"},{default:(0,r.k6)(()=>[(0,r.bF)(k,{layout:"inline"},{default:(0,r.k6)(()=>[(0,r.bF)(x,{label:"æœç´¢"},{default:(0,r.k6)(()=>[(0,r.bF)(b,{value:s.searchInput,"onUpdate:value":t[0]||(t[0]=e=>s.searchInput=e),placeholder:"æœç´¢å‘Šè­¦å†…å®¹æˆ–è¾“å‡º...",onPressEnter:i.applyFilters,style:{width:"200px"}},{prefix:(0,r.k6)(()=>[(0,r.bF)(m)]),_:1},8,["value","onPressEnter"])]),_:1}),(0,r.bF)(x,{label:"åœºæ™¯åˆ†ç±»"},{default:(0,r.k6)(()=>[(0,r.bF)(_,{value:s.categoryFilter,"onUpdate:value":t[1]||(t[1]=e=>s.categoryFilter=e),placeholder:"é€‰æ‹©åœºæ™¯åˆ†ç±»",style:{width:"150px"},allowClear:"",onChange:i.applyFilters},{default:(0,r.k6)(()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.filterOptions?.categories,e=>((0,r.uX)(),(0,r.Wv)(y,{key:e,value:e},{default:(0,r.k6)(()=>[(0,r.eW)((0,n.v_)(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onChange"])]),_:1}),(0,r.bF)(x,{label:"é¢„æµ‹ç»“æœ"},{default:(0,r.k6)(()=>[(0,r.bF)(_,{value:s.correctnessFilter,"onUpdate:value":t[2]||(t[2]=e=>s.correctnessFilter=e),placeholder:"é€‰æ‹©é¢„æµ‹ç»“æœ",style:{width:"150px"},allowClear:"",onChange:i.applyFilters},{default:(0,r.k6)(()=>[(0,r.bF)(y,{value:"correct"},{default:(0,r.k6)(()=>[...t[3]||(t[3]=[(0,r.eW)("æ­£ç¡®",-1)])]),_:1}),(0,r.bF)(y,{value:"incorrect"},{default:(0,r.k6)(()=>[...t[4]||(t[4]=[(0,r.eW)("é”™è¯¯",-1)])]),_:1}),(0,r.bF)(y,{value:"parse_failed"},{default:(0,r.k6)(()=>[...t[5]||(t[5]=[(0,r.eW)("è§£æå¤±è´¥",-1)])]),_:1})]),_:1},8,["value","onChange"])]),_:1}),(0,r.bF)(x,null,{default:(0,r.k6)(()=>[(0,r.bF)(v,{type:"primary",onClick:i.applyFilters},{default:(0,r.k6)(()=>[...t[6]||(t[6]=[(0,r.eW)(" ç­›é€‰ ",-1)])]),_:1},8,["onClick"]),(0,r.bF)(v,{onClick:e.clearFilters,style:{"margin-left":"8px"}},{default:(0,r.k6)(()=>[...t[7]||(t[7]=[(0,r.eW)(" æ¸…ç©º ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),(0,r.bF)(F,{class:"results-table",title:"è¯„æµ‹ç»“æœåˆ—è¡¨"},{default:(0,r.k6)(()=>[(0,r.bF)(C,{columns:s.columns,dataSource:e.results,loading:e.loading,pagination:i.tablePagination,onChange:i.handleTableChange,rowKey:(e,t)=>e.alarm_id||`row-${t}`},{bodyCell:(0,r.k6)(({column:e,record:l})=>["alarm_id"===e.key?((0,r.uX)(),(0,r.Wv)(E,{key:0,copyable:"","copy-text":l.alarm_id,style:{"font-family":"monospace","font-size":"12px"}},{default:(0,r.k6)(()=>[(0,r.eW)((0,n.v_)(l.alarm_id),1)]),_:2},1032,["copy-text"])):(0,r.Q3)("",!0),"alarm_content"===e.key?((0,r.uX)(),(0,r.CE)("div",d,(0,n.v_)(i.getAlarmContent(l.input)),1)):(0,r.Q3)("",!0),"reference_label"===e.key?((0,r.uX)(),(0,r.Wv)(L,{key:2,color:"convergent"===l.reference_label?"green":"red"},{default:(0,r.k6)(()=>[(0,r.eW)((0,n.v_)("convergent"===l.reference_label?"æ”¶æ•›":"ä¸æ”¶æ•›"),1)]),_:2},1032,["color"])):(0,r.Q3)("",!0),"correctness"===e.key?((0,r.uX)(),(0,r.Wv)(L,{key:3,color:l.correct?"green":null===l.predicted_label?"orange":"red"},{default:(0,r.k6)(()=>[(0,r.eW)((0,n.v_)(i.getCorrectnessText(l)),1)]),_:2},1032,["color"])):(0,r.Q3)("",!0),"category"===e.key?((0,r.uX)(),(0,r.Wv)(L,{key:4,color:"blue"},{default:(0,r.k6)(()=>[(0,r.eW)((0,n.v_)(l.meta?.category||"-"),1)]),_:2},1024)):(0,r.Q3)("",!0),"excel_name"===e.key?((0,r.uX)(),(0,r.Wv)(w,{key:5,title:i.getExcelFileName(l),placement:"topLeft"},{default:(0,r.k6)(()=>[(0,r.Lk)("span",u,(0,n.v_)(i.getExcelFileName(l)),1)]),_:2},1032,["title"])):(0,r.Q3)("",!0),"sheet_name"===e.key?((0,r.uX)(),(0,r.Wv)(w,{key:6,title:i.getSheetName(l),placement:"topLeft"},{default:(0,r.k6)(()=>[(0,r.Lk)("span",p,(0,n.v_)(i.getSheetName(l)),1)]),_:2},1032,["title"])):(0,r.Q3)("",!0),"actions"===e.key?((0,r.uX)(),(0,r.Wv)(v,{key:7,type:"link",size:"small",onClick:e=>i.viewDetail(l.alarm_id)},{default:(0,r.k6)(()=>[...t[8]||(t[8]=[(0,r.eW)(" æŸ¥çœ‹è¯¦æƒ… ",-1)])]),_:1},8,["onClick"])):(0,r.Q3)("",!0)]),_:1},8,["columns","dataSource","loading","pagination","onChange","rowKey"])]),_:1}),e.hasData||e.loading?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.Wv)(T,{key:1,description:"æš‚æ— æ•°æ®ï¼Œè¯·å…ˆä¸Šä¼ è¯„æµ‹ç»“æœæ–‡ä»¶"},{image:(0,r.k6)(()=>[(0,r.bF)(S,{style:{"font-size":"64px",color:"#d9d9d9"}})]),_:1}))])}var g=l(6473),f=l(1262),m=l(6278),b={name:"Home",components:{SearchOutlined:g.A,UploadOutlined:f.A},data(){return{searchInput:"",categoryFilter:null,correctnessFilter:null,columns:[{title:"å‘Šè­¦ID",key:"alarm_id",width:150,ellipsis:!0},{title:"å‘Šè­¦å†…å®¹",key:"alarm_content",width:250,ellipsis:!0},{title:"çœŸå®æ ‡ç­¾",key:"reference_label",width:120,align:"center"},{title:"æ­£ç¡®æ€§",key:"correctness",width:100,align:"center"},{title:"åœºæ™¯åˆ†ç±»",key:"category",width:120,align:"center"},{title:"Excelåç§°",key:"excel_name",width:180,ellipsis:!0},{title:"Sheetåç§°",key:"sheet_name",width:180,ellipsis:!0},{title:"æ“ä½œ",key:"actions",width:100,align:"center",fixed:"right"}]}},computed:{...(0,m.aH)("results",["results","stats","filterOptions","loading"]),...(0,m.aH)("filters",["filters"]),...(0,m.L8)("results",["hasData"]),tablePagination(){return{current:this.$store.state.results.pagination.page,pageSize:this.$store.state.results.pagination.size,total:this.$store.state.results.pagination.total,showSizeChanger:!1,showQuickJumper:!0,showTotal:(e,t)=>`ç¬¬ ${t[0]}-${t[1]} æ¡ï¼Œå…± ${e} æ¡`}}},async created(){await this.fetchFilterOptions(),await this.fetchStats(),await this.fetchResults(1)},methods:{...(0,m.i0)("results",["fetchResults","fetchStats","fetchFilterOptions"]),...(0,m.i0)("filters",["updateFilter","clearFilters"]),getAlarmContent(e){const t=e.split("\n");for(const l of t)if(l.startsWith("å‘Šè­¦å†…å®¹ï¼š"))return l.replace("å‘Šè­¦å†…å®¹ï¼š","").slice(0,100)+(l.length>100?"...":"");return e.slice(0,100)+"..."},getPredictionTagColor(e){return null===e.predicted_label?"orange":e.correct?"green":"red"},getCorrectnessText(e){return null===e.predicted_label?"è§£æå¤±è´¥":e.correct?"æ­£ç¡®":"é”™è¯¯"},getExcelFileName(e){if(!e||!e.meta||!e.meta.scenario_id)return"-";const t=e.meta.scenario_id,l=t.lastIndexOf("_");return l>0?t.substring(0,l):t},getSheetName(e){if(!e||!e.meta||!e.meta.scenario_id)return"-";const t=e.meta.scenario_id,l=t.lastIndexOf("_");return l>0&&l<t.length-1?t.substring(l+1):"-"},applyFilters(){this.updateFilter({key:"search",value:this.searchInput}),this.updateFilter({key:"category",value:this.categoryFilter}),this.updateFilter({key:"correctness",value:this.correctnessFilter})},handleTableChange(e){e&&this.fetchResults(e.current)},viewDetail(e){e?this.$router.push({name:"Detail",params:{alarmId:e}}):this.$message.error("ç¼ºå°‘å‘Šè­¦IDï¼Œæ— æ³•æŸ¥çœ‹è¯¦æƒ…")}}},x=l(6262);const y=(0,x.A)(b,[["render",h],["__scopeId","data-v-0f874427"]]);var _=y;const v={class:"detail"},k={class:"back-button"},F={key:0,class:"navigation"},E={key:0,class:"filter-info"},L={class:"page-info"},w={key:0,style:{color:"#1890ff","margin-left":"8px"}},C={key:1,class:"result-detail"},S={class:"meta-item"},T={class:"meta-item"},A={class:"meta-item"},R={class:"meta-item"},O={class:"meta-item"},D={class:"prediction-tags"},$={class:"content-text"},I={class:"comparison-section"},P={class:"comparison-text"},W={class:"comparison-section"},X={class:"comparison-text"},U={key:0,class:"excel-disabled-hint"},N={key:1,class:"excel-error"},z={key:2,class:"excel-loading"},Q={key:3,class:"excel-table-container"};function j(e,t,l,a,s,i){const o=(0,r.g2)("ArrowLeftOutlined"),c=(0,r.g2)("a-button"),d=(0,r.g2)("a-alert"),u=(0,r.g2)("LeftOutlined"),p=(0,r.g2)("RightOutlined"),h=(0,r.g2)("a-space"),g=(0,r.g2)("a-typography-text"),f=(0,r.g2)("a-col"),m=(0,r.g2)("a-tag"),b=(0,r.g2)("a-row"),x=(0,r.g2)("a-card"),y=(0,r.g2)("FileTextOutlined"),_=(0,r.g2)("a-spin"),j=(0,r.g2)("a-table"),M=(0,r.g2)("a-empty"),q=(0,r.g2)("a-result"),H=(0,r.gN)("loading");return(0,r.bo)(((0,r.uX)(),(0,r.CE)("div",v,[(0,r.Lk)("div",k,[(0,r.bF)(c,{onClick:i.goBack},{icon:(0,r.k6)(()=>[(0,r.bF)(o)]),default:(0,r.k6)(()=>[t[3]||(t[3]=(0,r.eW)(" è¿”å›åˆ—è¡¨ ",-1))]),_:1},8,["onClick"])]),s.navigation?((0,r.uX)(),(0,r.CE)("div",F,[(0,r.bF)(h,{direction:"vertical",style:{width:"100%"}},{default:(0,r.k6)(()=>[i.hasActiveFilters&&s.filterInfoVisible?((0,r.uX)(),(0,r.CE)("div",E,[(0,r.bF)(d,{type:"info",message:i.filterInfoText,description:`å½“å‰ç­›é€‰åå…± ${s.navigation.total} æ¡è®°å½•`,"show-icon":"",closable:"",onClose:t[0]||(t[0]=e=>s.filterInfoVisible=!1)},null,8,["message","description"])])):(0,r.Q3)("",!0),(0,r.bF)(h,null,{default:(0,r.k6)(()=>[(0,r.bF)(c,{disabled:!s.navigation.previous,onClick:t[1]||(t[1]=e=>i.goToResult(s.navigation.previous))},{icon:(0,r.k6)(()=>[(0,r.bF)(u)]),default:(0,r.k6)(()=>[t[4]||(t[4]=(0,r.eW)(" ä¸Šä¸€æ¡ ",-1))]),_:1},8,["disabled"]),(0,r.Lk)("span",L,[(0,r.eW)((0,n.v_)(s.navigation.current_index)+" / "+(0,n.v_)(s.navigation.total)+" ",1),i.hasActiveFilters?((0,r.uX)(),(0,r.CE)("span",w," (ç­›é€‰å) ")):(0,r.Q3)("",!0)]),(0,r.bF)(c,{disabled:!s.navigation.next,onClick:t[2]||(t[2]=e=>i.goToResult(s.navigation.next))},{icon:(0,r.k6)(()=>[(0,r.bF)(p)]),default:(0,r.k6)(()=>[t[5]||(t[5]=(0,r.eW)(" ä¸‹ä¸€æ¡ ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})])):(0,r.Q3)("",!0),i.result?((0,r.uX)(),(0,r.CE)("div",C,[(0,r.bF)(x,{class:"meta-card",title:"åŸºæœ¬ä¿¡æ¯"},{default:(0,r.k6)(()=>[(0,r.bF)(b,{gutter:16},{default:(0,r.k6)(()=>[(0,r.bF)(f,{span:6},{default:(0,r.k6)(()=>[(0,r.Lk)("div",S,[t[6]||(t[6]=(0,r.Lk)("span",{class:"label"},"å‘Šè­¦ID:",-1)),(0,r.bF)(g,{copyable:""},{default:(0,r.k6)(()=>[(0,r.eW)((0,n.v_)(i.result.alarm_id),1)]),_:1})])]),_:1}),(0,r.bF)(f,{span:6},{default:(0,r.k6)(()=>[(0,r.Lk)("div",T,[t[7]||(t[7]=(0,r.Lk)("span",{class:"label"},"Excelæ–‡ä»¶:",-1)),(0,r.Lk)("span",null,(0,n.v_)(i.getExcelFileName(i.result)),1)])]),_:1}),(0,r.bF)(f,{span:6},{default:(0,r.k6)(()=>[(0,r.Lk)("div",A,[t[8]||(t[8]=(0,r.Lk)("span",{class:"label"},"Sheetå:",-1)),(0,r.Lk)("span",null,(0,n.v_)(i.getSheetName(i.result)),1)])]),_:1}),(0,r.bF)(f,{span:6},{default:(0,r.k6)(()=>[(0,r.Lk)("div",R,[t[9]||(t[9]=(0,r.Lk)("span",{class:"label"},"åœºæ™¯åˆ†ç±»:",-1)),(0,r.bF)(m,{color:"blue"},{default:(0,r.k6)(()=>[(0,r.eW)((0,n.v_)(i.result.meta?.category||"-"),1)]),_:1})])]),_:1}),(0,r.bF)(f,{span:6},{default:(0,r.k6)(()=>[(0,r.Lk)("div",O,[t[10]||(t[10]=(0,r.Lk)("span",{class:"label"},"é¢„æµ‹ç»“æœ:",-1)),(0,r.Lk)("div",D,[(0,r.bF)(m,{color:i.getPredictionTagColor(i.result),style:{"margin-right":"4px"}},{default:(0,r.k6)(()=>[(0,r.eW)((0,n.v_)(i.getPredictionLabelDisplay(i.result)),1)]),_:1},8,["color"]),(0,r.bF)(m,{color:i.result.correct?"green":null===i.result.predicted_label?"orange":"red"},{default:(0,r.k6)(()=>[(0,r.eW)((0,n.v_)(i.getCorrectnessText(i.result)),1)]),_:1},8,["color"])])])]),_:1})]),_:1})]),_:1}),(0,r.bF)(x,{title:"æ¨¡å‹è¾“å…¥",class:"input-card",style:{"margin-bottom":"20px"}},{default:(0,r.k6)(()=>[(0,r.Lk)("pre",$,(0,n.v_)(i.result.input),1)]),_:1}),(0,r.bF)(x,{class:"comparison-card",title:"è¾“å‡ºå¯¹æ¯”åˆ†æ",style:{"margin-bottom":"20px"}},{default:(0,r.k6)(()=>[(0,r.bF)(b,{gutter:16},{default:(0,r.k6)(()=>[(0,r.bF)(f,{span:12},{default:(0,r.k6)(()=>[(0,r.Lk)("div",I,[t[11]||(t[11]=(0,r.Lk)("h4",null,"äººå·¥æ ‡æ³¨è¾“å‡º",-1)),(0,r.Lk)("pre",P,(0,n.v_)(i.result.expected_output),1)])]),_:1}),(0,r.bF)(f,{span:12},{default:(0,r.k6)(()=>[(0,r.Lk)("div",W,[t[12]||(t[12]=(0,r.Lk)("h4",null,"æ¨¡å‹è¾“å‡º",-1)),(0,r.Lk)("pre",X,(0,n.v_)(i.result.model_output),1)])]),_:1})]),_:1})]),_:1}),(0,r.bF)(x,{class:"excel-card",title:"Excelä¸Šä¸‹æ–‡"},{extra:(0,r.k6)(()=>[(0,r.bF)(c,{type:"primary",onClick:i.loadExcelContext,loading:s.excelLoading,disabled:!i.canLoadExcel},{icon:(0,r.k6)(()=>[(0,r.bF)(y)]),default:(0,r.k6)(()=>[(0,r.eW)(" "+(0,n.v_)(s.excelData?"é‡æ–°åŠ è½½":"åŠ è½½ä¸Šä¸‹æ–‡"),1)]),_:1},8,["onClick","loading","disabled"])]),default:(0,r.k6)(()=>[!i.canLoadExcel&&i.result?((0,r.uX)(),(0,r.CE)("div",U,[(0,r.bF)(d,{message:i.getExcelDisabledReason(),type:"warning","show-icon":"",style:{"margin-bottom":"16px"}},null,8,["message"])])):(0,r.Q3)("",!0),s.excelError?((0,r.uX)(),(0,r.CE)("div",N,[(0,r.bF)(d,{message:s.excelError,type:"error","show-icon":"",description:s.excelError.includes("æœªæ‰¾åˆ°åŒ¹é…")?"è¯·æ£€æŸ¥Excelæ–‡ä»¶è·¯å¾„é…ç½®ï¼Œæˆ–ç¡®è®¤æ–‡ä»¶åæ˜¯å¦æ­£ç¡®ã€‚":""},null,8,["message","description"])])):s.excelLoading?((0,r.uX)(),(0,r.CE)("div",z,[(0,r.bF)(_,{size:"large",tip:"æ­£åœ¨åŠ è½½Excelæ•°æ®..."},{default:(0,r.k6)(()=>[...t[13]||(t[13]=[(0,r.Lk)("div",{style:{height:"200px"}},null,-1)])]),_:1})])):s.excelData&&s.excelData.length>0?((0,r.uX)(),(0,r.CE)("div",Q,[(0,r.bF)(j,{columns:s.excelColumns,dataSource:s.excelData,pagination:{pageSize:20,showSizeChanger:!0},scroll:{x:"max-content",y:400},size:"small",bordered:""},null,8,["columns","dataSource"])])):((0,r.uX)(),(0,r.Wv)(M,{key:4,description:"ç‚¹å‡»ã€ŒåŠ è½½ä¸Šä¸‹æ–‡ã€æŒ‰é’®åŠ è½½Excelæ•°æ®",image:!1}))]),_:1})])):e.error?((0,r.uX)(),(0,r.Wv)(q,{key:2,status:"error",title:"åŠ è½½å¤±è´¥","sub-title":e.error},{extra:(0,r.k6)(()=>[(0,r.bF)(c,{type:"primary",onClick:i.retryLoad},{default:(0,r.k6)(()=>[...t[14]||(t[14]=[(0,r.eW)(" é‡è¯• ",-1)])]),_:1},8,["onClick"])]),_:1},8,["sub-title"])):(0,r.Q3)("",!0)])),[[H,e.loading]])}var M=l(8546),q=l(8898),H=l(5118),V=l(8517),G=l(4335),K={name:"Detail",components:{ArrowLeftOutlined:M.A,LeftOutlined:q.A,RightOutlined:H.A,FileTextOutlined:V.A},props:{alarmId:{type:String,required:!0}},data(){return{navigation:null,navLoading:!1,excelLoading:!1,excelData:null,excelError:null,excelColumns:[],filterInfoVisible:!0}},computed:{...(0,m.aH)("results",["currentResult","loading","error"]),...(0,m.aH)("filters",["filters"]),result(){return this.currentResult},routeAlarmId(){return this.$route.params.alarmId||this.alarmId},hasActiveFilters(){return!!(this.filters.search||this.filters.category||this.filters.correctness)},filterInfoText(){const e=[];if(this.filters.search&&e.push(`æœç´¢: "${this.filters.search}"`),this.filters.category&&e.push(`åœºæ™¯åˆ†ç±»: ${this.filters.category}`),this.filters.correctness){const t={correct:"æ­£ç¡®",incorrect:"é”™è¯¯",parse_failed:"è§£æå¤±è´¥"};e.push(`é¢„æµ‹ç»“æœ: ${t[this.filters.correctness]||this.filters.correctness}`)}return e.length>0?`å½“å‰ç­›é€‰: ${e.join(", ")}`:""}},async created(){await this.loadData()},watch:{alarmId:{handler:"loadData",immediate:!1},"$route.params.alarmId":{handler:"loadData",immediate:!1},"filters.search":{handler:"loadNavigation",immediate:!1},"filters.category":{handler:"loadNavigation",immediate:!1},"filters.correctness":{handler:"loadNavigation",immediate:!1}},methods:{...(0,m.i0)("results",["fetchResultDetail"]),async loadData(){const e=this.$route?.params?.alarmId||this.alarmId;e?(await this.fetchResultDetail(e),await this.loadNavigation(),this.excelData=null,this.excelError=null,this.excelColumns=[]):console.error("ç¼ºå°‘å‘Šè­¦IDï¼Œæ— æ³•åŠ è½½æ•°æ®")},async loadNavigation(){const e=this.$route?.params?.alarmId||this.alarmId;if(e){this.navLoading=!0;try{const t=new URLSearchParams;this.filters.search&&t.append("search",this.filters.search),this.filters.category&&t.append("category",this.filters.category),this.filters.correctness&&t.append("correctness",this.filters.correctness);const l=t.toString(),a=`/results/${e}/navigation${l?"?"+l:""}`,s=await G.A.get(a);this.navigation=s.data}catch(t){console.error("åŠ è½½å¯¼èˆªä¿¡æ¯å¤±è´¥:",t)}finally{this.navLoading=!1}}},goBack(){this.$router.push({name:"Home"})},goToResult(e){e&&this.$router.push({name:"Detail",params:{alarmId:e}})},getPredictionTagColor(e){return e&&null!==e.predicted_label?e.correct?"green":"red":"orange"},getPredictionLabelDisplay(e){return e?null===e.predicted_label?"è§£æå¤±è´¥":"convergent"===e.predicted_label?"æ”¶æ•›":"non_convergent"===e.predicted_label?"ä¸æ”¶æ•›":e.predicted_label||"-":"-"},getCorrectnessText(e){return e&&null!==e.predicted_label?e.correct?"æ­£ç¡®":"é”™è¯¯":"è§£æå¤±è´¥"},getExcelFileName(e){if(!e||!e.meta||!e.meta.scenario_id)return"-";const t=e.meta.scenario_id,l=t.lastIndexOf("_");return l>0?t.substring(0,l):t},getSheetName(e){if(!e||!e.meta||!e.meta.scenario_id)return"-";const t=e.meta.scenario_id,l=t.lastIndexOf("_");return l>0&&l<t.length-1?t.substring(l+1):"-"},get canLoadExcel(){const e=!this.loading,t=this.$route?.params?.alarmId,l=this.alarmId,a=this.result?.alarm_id,s=!!(t||l||a),i=!!this.result,r=e&&s&&i;return r},getExcelDisabledReason(){if(this.loading)return"æ•°æ®æ­£åœ¨åŠ è½½ä¸­ï¼Œè¯·ç¨å€™...";if(!this.result)return"ç»“æœæ•°æ®æœªåŠ è½½ï¼Œæ— æ³•åŠ è½½Excelä¸Šä¸‹æ–‡";const e=this.$route?.params?.alarmId,t=this.alarmId,l=this.result?.alarm_id;return e||t||l?'è¯·å…ˆé…ç½®Excelæ–‡ä»¶è·¯å¾„ï¼ˆåœ¨åˆ—è¡¨é¡µç‚¹å‡»"é…ç½®æ•°æ®è·¯å¾„"æŒ‰é’®ï¼‰':"ç¼ºå°‘å‘Šè­¦IDï¼Œæ— æ³•åŠ è½½Excelä¸Šä¸‹æ–‡"},async loadExcelContext(){const e=this.$route?.params?.alarmId||this.alarmId||this.result&&this.result.alarm_id;if(e){this.excelLoading=!0,this.excelError=null,this.excelData=null;try{const t=await G.A.get(`/results/${e}/excel-context`);if(t.data.error){if(this.excelError=t.data.error,t.data.excel_file_name_expected){let e=`æœªæ‰¾åˆ°åŒ¹é…çš„Excelæ–‡ä»¶ã€‚\næœŸæœ›çš„æ–‡ä»¶ååŒ…å«: ${t.data.excel_file_name_expected}\n\nå¯ç”¨æ–‡ä»¶æ•°é‡: ${t.data.excel_files_count||0}`;t.data.excel_files_available&&t.data.excel_files_available.length>0&&(e+=`\n\néƒ¨åˆ†å¯ç”¨æ–‡ä»¶:\n${t.data.excel_files_available.slice(0,5).join("\n")}`),this.excelError=e}this.$message.error("åŠ è½½Excelä¸Šä¸‹æ–‡å¤±è´¥ï¼š"+t.data.error)}else t.data.data&&t.data.data.length>0?(this.excelData=t.data.data,this.generateExcelColumns(t.data.data),this.$message.success(`æˆåŠŸåŠ è½½ ${t.data.total_rows} è¡Œæ•°æ®`)):(this.excelError="Excelæ–‡ä»¶ä¸­æ²¡æœ‰æ•°æ®",this.$message.warning("Excelæ–‡ä»¶ä¸­æ²¡æœ‰æ•°æ®"))}catch(t){console.error("åŠ è½½Excelä¸Šä¸‹æ–‡å¤±è´¥:",t);const e=t.response?.data;if(e&&e.error){if(this.excelError=e.error,e.excel_file_name_expected){let t=`æœªæ‰¾åˆ°åŒ¹é…çš„Excelæ–‡ä»¶ã€‚\næœŸæœ›çš„æ–‡ä»¶ååŒ…å«: ${e.excel_file_name_expected}\n\nå¯ç”¨æ–‡ä»¶æ•°é‡: ${e.excel_files_count||0}`;e.excel_files_available&&e.excel_files_available.length>0&&(t+=`\n\néƒ¨åˆ†å¯ç”¨æ–‡ä»¶:\n${e.excel_files_available.slice(0,5).join("\n")}`),this.excelError=t}this.$message.error("åŠ è½½Excelä¸Šä¸‹æ–‡å¤±è´¥ï¼š"+e.error)}else this.excelError=t.message||"åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–è”ç³»ç®¡ç†å‘˜",this.$message.error("åŠ è½½Excelä¸Šä¸‹æ–‡å¤±è´¥ï¼š"+this.excelError)}finally{this.excelLoading=!1}}else this.$message.warning("ç¼ºå°‘å‘Šè­¦IDï¼Œæ— æ³•åŠ è½½Excelä¸Šä¸‹æ–‡")},generateExcelColumns(e){if(!e||0===e.length)return void(this.excelColumns=[]);const t=e[0];this.excelColumns=Object.keys(t).map(e=>({title:e,dataIndex:e,key:e,width:150,ellipsis:!0}))},retryLoad(){this.loadData()}}};const B=(0,x.A)(K,[["render",j],["__scopeId","data-v-52f2c3a0"]]);var J=B;const Y=[{path:"/",name:"Home",component:_,meta:{title:"è¯„æµ‹ç»“æœåˆ—è¡¨"}},{path:"/detail/:alarmId",name:"Detail",component:J,meta:{title:"è¯„æµ‹ç»“æœè¯¦æƒ…"},props:!0}],Z=(0,i.aE)({history:(0,i.LA)(),routes:Y});Z.beforeEach((e,t,l)=>{e.meta.title&&(document.title=`${e.meta.title} - è¯„æµ‹ç»“æœå±•ç¤ºç³»ç»Ÿ`),l()});var ee=Z,te={namespaced:!0,state:{results:[],currentResult:null,stats:null,filterOptions:null,pagination:{page:1,size:20,total:0,pages:0},loading:!1,error:null},mutations:{SET_RESULTS(e,{results:t,pagination:l}){e.results=t,e.pagination=l},SET_CURRENT_RESULT(e,t){e.currentResult=t},SET_STATS(e,t){e.stats=t},SET_FILTER_OPTIONS(e,t){e.filterOptions=t},SET_LOADING(e,t){e.loading=t},SET_ERROR(e,t){e.error=t},CLEAR_DATA(e){e.results=[],e.currentResult=null,e.stats=null,e.filterOptions=null,e.pagination={page:1,size:20,total:0,pages:0}}},actions:{async fetchResults({commit:e,rootState:t},l=1){e("SET_LOADING",!0),e("SET_ERROR",null);try{const a=t.filters.filters,s={page:l,size:20,...a};Object.keys(s).forEach(e=>{null!==s[e]&&void 0!==s[e]&&""!==s[e]||delete s[e]});const i=await G.A.get("/results",{params:s}),r={page:i.data.pagination.page,size:i.data.pagination.size,total:i.data.pagination.total,pages:i.data.pagination.pages};e("SET_RESULTS",{results:i.data.results,pagination:r})}catch(a){console.error("è·å–ç»“æœå¤±è´¥:",a),e("SET_ERROR",a.response?.data?.detail||a.message)}finally{e("SET_LOADING",!1)}},async fetchResultDetail({commit:e},t){e("SET_LOADING",!0),e("SET_ERROR",null);try{const l=await G.A.get(`/results/${t}`);e("SET_CURRENT_RESULT",l.data)}catch(l){console.error("è·å–ç»“æœè¯¦æƒ…å¤±è´¥:",l),e("SET_ERROR",l.response?.data?.detail||l.message)}finally{e("SET_LOADING",!1)}},async fetchStats({commit:e}){try{const t=await G.A.get("/stats/overview");e("SET_STATS",t.data)}catch(t){console.error("è·å–ç»Ÿè®¡ä¿¡æ¯å¤±è´¥:",t),e("SET_ERROR",t.response?.data?.detail||t.message)}},async fetchFilterOptions({commit:e}){try{const t=await G.A.get("/filters/options");e("SET_FILTER_OPTIONS",t.data)}catch(t){console.error("è·å–ç­›é€‰é€‰é¡¹å¤±è´¥:",t),e("SET_ERROR",t.response?.data?.detail||t.message)}},async clearData({commit:e}){try{await G.A.delete("/data"),e("CLEAR_DATA")}catch(t){console.error("æ¸…é™¤æ•°æ®å¤±è´¥:",t),e("SET_ERROR",t.response?.data?.detail||t.message)}}},getters:{hasData:e=>e.results.length>0||null!==e.currentResult,currentPage:e=>e.pagination.page,totalPages:e=>e.pagination.pages,totalResults:e=>e.pagination.total}},le={namespaced:!0,state:{filters:{search:"",category:null,correctness:null,scenario_id:null,reference_label:null,alarm_id:null,excel_name:null,sheet_name:null}},mutations:{SET_FILTER(e,{key:t,value:l}){e.filters[t]=l},SET_FILTERS(e,t){e.filters={...t}},CLEAR_FILTERS(e){e.filters={search:"",category:null,correctness:null,scenario_id:null,reference_label:null,alarm_id:null,excel_name:null,sheet_name:null}}},actions:{updateFilter({commit:e,dispatch:t},{key:l,value:a}){e("SET_FILTER",{key:l,value:a}),t("results/fetchResults",1,{root:!0})},setFilters({commit:e,dispatch:t},l){e("SET_FILTERS",l),t("results/fetchResults",1,{root:!0})},clearFilters({commit:e,dispatch:t}){e("CLEAR_FILTERS"),t("results/fetchResults",1,{root:!0})}},getters:{activeFiltersCount:e=>{let t=0;return e.filters.search&&t++,e.filters.category&&t++,e.filters.correctness&&t++,e.filters.scenario_id&&t++,e.filters.reference_label&&t++,e.filters.alarm_id&&t++,e.filters.excel_name&&t++,e.filters.sheet_name&&t++,t},hasActiveFilters:(e,t)=>t.activeFiltersCount>0}},ae=(0,m.y$)({modules:{results:te,filters:le}});const se={id:"app"},ie={class:"header-info"},re={class:"path-info"},ne={class:"path-info"},oe={class:"header-actions"};function ce(e,t,l,a,s,i){const o=(0,r.g2)("FileOutlined"),c=(0,r.g2)("a-tooltip"),d=(0,r.g2)("FileTextOutlined"),u=(0,r.g2)("UploadOutlined"),p=(0,r.g2)("a-button"),h=(0,r.g2)("a-layout-header"),g=(0,r.g2)("router-view"),f=(0,r.g2)("a-layout-content"),m=(0,r.g2)("a-layout-footer"),b=(0,r.g2)("a-layout"),x=(0,r.g2)("UploadModal");return(0,r.uX)(),(0,r.CE)("div",se,[(0,r.bF)(b,{class:"layout"},{default:(0,r.k6)(()=>[(0,r.bF)(h,{class:"header"},{default:(0,r.k6)(()=>[t[2]||(t[2]=(0,r.Lk)("div",{class:"logo"},[(0,r.Lk)("h2",{style:{color:"white",margin:"0"}},"è¯„æµ‹ç»“æœå±•ç¤ºç³»ç»Ÿ")],-1)),(0,r.Lk)("div",ie,[s.configPaths.excel_dir_path?((0,r.uX)(),(0,r.Wv)(c,{key:0,title:s.configPaths.excel_dir_path},{default:(0,r.k6)(()=>[(0,r.Lk)("span",re,[(0,r.bF)(o),(0,r.eW)(" Excel: "+(0,n.v_)(i.truncatePath(s.configPaths.excel_dir_path)),1)])]),_:1},8,["title"])):(0,r.Q3)("",!0),s.configPaths.results_file_path?((0,r.uX)(),(0,r.Wv)(c,{key:1,title:s.configPaths.results_file_path},{default:(0,r.k6)(()=>[(0,r.Lk)("span",ne,[(0,r.bF)(d),(0,r.eW)(" ç»“æœ: "+(0,n.v_)(i.truncatePath(s.configPaths.results_file_path)),1)])]),_:1},8,["title"])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",oe,[(0,r.bF)(p,{type:"primary",onClick:i.showUploadModal},{icon:(0,r.k6)(()=>[(0,r.bF)(u)]),default:(0,r.k6)(()=>[t[1]||(t[1]=(0,r.eW)(" ä¸Šä¼ æ•°æ® ",-1))]),_:1},8,["onClick"])])]),_:1}),(0,r.bF)(f,{class:"content"},{default:(0,r.k6)(()=>[(0,r.bF)(g)]),_:1}),(0,r.bF)(m,{class:"footer"},{default:(0,r.k6)(()=>[...t[3]||(t[3]=[(0,r.eW)(" è¯„æµ‹ç»“æœå±•ç¤ºç³»ç»Ÿ Â©2024 ",-1)])]),_:1})]),_:1}),(0,r.bF)(x,{open:s.uploadModalVisible,"onUpdate:open":t[0]||(t[0]=e=>s.uploadModalVisible=e),onUploaded:i.handleUploaded},null,8,["open","onUploaded"])])}var de=l(1951);const ue={class:"upload-modal"},pe={class:"form-hint"},he={key:0,class:"scan-result"},ge={class:"excel-files-list"},fe={key:1,class:"scan-result"},me={key:0,class:"load-result"},be={key:0,class:"form-hint",style:{"margin-top":"8px","text-align":"center"}},xe={key:0},ye={key:1},_e={class:"modal-footer"};function ve(e,t,l,a,s,i){const o=(0,r.g2)("FolderOpenOutlined"),c=(0,r.g2)("a-input"),d=(0,r.g2)("a-button"),u=(0,r.g2)("a-form-item"),p=(0,r.g2)("a-form"),h=(0,r.g2)("a-alert"),g=(0,r.g2)("FileTextOutlined"),f=(0,r.g2)("a-card"),m=(0,r.g2)("a-space"),b=(0,r.g2)("a-modal");return(0,r.uX)(),(0,r.Wv)(b,{open:i.visible,"onUpdate:open":t[2]||(t[2]=e=>i.visible=e),title:"é…ç½®æ•°æ®è·¯å¾„",width:"700px",footer:null,destroyOnClose:!0},{default:(0,r.k6)(()=>[(0,r.Lk)("div",ue,[(0,r.bF)(f,{title:"æ­¥éª¤1: æ‰«æExcelæ–‡ä»¶",class:"upload-card"},{default:(0,r.k6)(()=>[(0,r.bF)(p,{layout:"vertical"},{default:(0,r.k6)(()=>[(0,r.bF)(u,{label:"Excelæ•°æ®ç›®å½•è·¯å¾„"},{default:(0,r.k6)(()=>[(0,r.bF)(c,{value:s.excelDirPath,"onUpdate:value":t[0]||(t[0]=e=>s.excelDirPath=e),placeholder:"./data æˆ– /path/to/excel/files",disabled:s.scanning||s.excelFilesScanned},{prefix:(0,r.k6)(()=>[(0,r.bF)(o)]),_:1},8,["value","disabled"]),(0,r.Lk)("div",pe,[(0,r.bF)(d,{type:"link",onClick:i.selectDirectory,disabled:s.scanning||s.excelFilesScanned,style:{padding:"0",height:"auto"}},{default:(0,r.k6)(()=>[...t[3]||(t[3]=[(0,r.eW)(" ğŸ“ é€‰æ‹©ç›®å½• ",-1)])]),_:1},8,["onClick","disabled"]),t[5]||(t[5]=(0,r.Lk)("span",{style:{margin:"0 8px"}},"|",-1)),(0,r.bF)(d,{type:"link",onClick:i.showDirectoryPicker,disabled:s.scanning||s.excelFilesScanned,style:{padding:"0",height:"auto"}},{default:(0,r.k6)(()=>[...t[4]||(t[4]=[(0,r.eW)(" ğŸ“ å¿«é€Ÿé€‰æ‹©å¸¸ç”¨è·¯å¾„ ",-1)])]),_:1},8,["onClick","disabled"])])]),_:1}),(0,r.bF)(u,null,{default:(0,r.k6)(()=>[(0,r.bF)(d,{type:"primary",onClick:i.scanExcelFiles,loading:s.scanning,disabled:!s.excelDirPath||s.excelFilesScanned},{default:(0,r.k6)(()=>[(0,r.eW)((0,n.v_)(s.excelFilesScanned?"âœ… å·²æ‰«æ":"ğŸ” æ‰«æExcelæ–‡ä»¶"),1)]),_:1},8,["onClick","loading","disabled"])]),_:1})]),_:1}),s.excelFilesScanned&&s.scannedExcelFiles.length>0?((0,r.uX)(),(0,r.CE)("div",he,[(0,r.bF)(h,{message:"æ‰«ææˆåŠŸ",description:`å…±æ‰¾åˆ° ${s.scannedExcelFiles.length} ä¸ªExcelæ–‡ä»¶`,type:"success","show-icon":"",style:{"margin-bottom":"12px"}},null,8,["description"]),(0,r.Lk)("div",ge,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.scannedExcelFiles,(e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:t,class:"excel-file-item"},[(0,r.bF)(g,{style:{"margin-right":"8px",color:"#1890ff"}}),(0,r.Lk)("span",null,(0,n.v_)(e),1)]))),128))])])):s.excelFilesScanned&&0===s.scannedExcelFiles.length?((0,r.uX)(),(0,r.CE)("div",fe,[(0,r.bF)(h,{message:"æœªæ‰¾åˆ°Excelæ–‡ä»¶",description:"è¯·ç¡®è®¤ç›®å½•è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼Œæˆ–ç›®å½•ä¸‹æ˜¯å¦åŒ…å« .xlsx æˆ– .xls æ–‡ä»¶",type:"warning","show-icon":""})])):(0,r.Q3)("",!0)]),_:1}),(0,r.bF)(f,{title:"æ­¥éª¤2: ä¸Šä¼ è¯„æµ‹ç»“æœæ–‡ä»¶",class:"upload-card"},{default:(0,r.k6)(()=>[(0,r.bF)(p,{layout:"vertical"},{default:(0,r.k6)(()=>[(0,r.bF)(u,{label:"è¯„æµ‹ç»“æœæ–‡ä»¶è·¯å¾„"},{default:(0,r.k6)(()=>[(0,r.bF)(c,{value:s.resultsFilePath,"onUpdate:value":t[1]||(t[1]=e=>s.resultsFilePath=e),placeholder:"./results/model_output.jsonl æˆ– /absolute/path/to/file.jsonl",disabled:s.uploading||s.resultsFileLoaded},{prefix:(0,r.k6)(()=>[(0,r.bF)(g)]),_:1},8,["value","disabled"]),t[6]||(t[6]=(0,r.Lk)("div",{class:"form-hint"},[(0,r.Lk)("span",null,"è¾“å…¥åŒ…å«æ¨¡å‹é¢„æµ‹ç»“æœçš„ .jsonl æ–‡ä»¶è·¯å¾„ï¼ˆæœ¬åœ°è·¯å¾„ï¼‰")],-1))]),_:1}),(0,r.bF)(u,null,{default:(0,r.k6)(()=>[(0,r.bF)(d,{type:"primary",onClick:i.loadResultsFile,loading:s.uploading,disabled:!s.resultsFilePath||s.resultsFileLoaded||!s.excelFilesScanned},{default:(0,r.k6)(()=>[(0,r.eW)((0,n.v_)(s.resultsFileLoaded?"âœ… å·²åŠ è½½":"ğŸ“„ åŠ è½½ç»“æœæ–‡ä»¶"),1)]),_:1},8,["onClick","loading","disabled"])]),_:1})]),_:1}),s.resultsFileLoaded?((0,r.uX)(),(0,r.CE)("div",me,[(0,r.bF)(h,{message:"æ–‡ä»¶åŠ è½½æˆåŠŸ",description:`å…±åŠ è½½ ${s.resultsFileStats.total_records||0} æ¡è®°å½•`,type:"success","show-icon":""},null,8,["description"])])):(0,r.Q3)("",!0)]),_:1}),(0,r.bF)(f,{title:"æ­¥éª¤3: å¼€å§‹åˆ†æ",class:"upload-card"},{default:(0,r.k6)(()=>[(0,r.bF)(d,{type:"primary",size:"large",onClick:i.startAnalysis,loading:s.analyzing,disabled:!s.excelFilesScanned||!s.resultsFileLoaded,block:""},{default:(0,r.k6)(()=>[...t[7]||(t[7]=[(0,r.eW)(" ğŸš€ å¼€å§‹åˆ†æ ",-1)])]),_:1},8,["onClick","loading","disabled"]),s.excelFilesScanned&&s.resultsFileLoaded?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",be,[s.excelFilesScanned?s.resultsFileLoaded?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("span",ye,"è¯·å…ˆå®Œæˆæ­¥éª¤2ï¼šåŠ è½½ç»“æœæ–‡ä»¶")):((0,r.uX)(),(0,r.CE)("span",xe,"è¯·å…ˆå®Œæˆæ­¥éª¤1ï¼šæ‰«æExcelæ–‡ä»¶"))]))]),_:1}),(0,r.Lk)("div",_e,[(0,r.bF)(m,null,{default:(0,r.k6)(()=>[(0,r.bF)(d,{onClick:i.clearData,loading:s.clearing,danger:""},{default:(0,r.k6)(()=>[...t[8]||(t[8]=[(0,r.eW)(" æ¸…ç©ºæ•°æ® ",-1)])]),_:1},8,["onClick","loading"]),(0,r.bF)(d,{onClick:i.closeModal},{default:(0,r.k6)(()=>[...t[9]||(t[9]=[(0,r.eW)(" å…³é—­ ",-1)])]),_:1},8,["onClick"])]),_:1})])])]),_:1},8,["open"])}var ke=l(9824),Fe=l(8787),Ee={name:"UploadModal",components:{FileTextOutlined:V.A,FolderOpenOutlined:ke.A},props:{open:{type:Boolean,default:!1}},emits:["update:open","uploaded"],data(){return{clearing:!1,analyzing:!1,scanning:!1,uploading:!1,resultsFilePath:"",excelDirPath:"./data",excelFilesScanned:!1,scannedExcelFiles:[],resultsFileLoaded:!1,resultsFileStats:{}}},computed:{visible:{get(){return this.open},set(e){this.$emit("update:open",e)}}},methods:{selectDirectory(){const e=document.createElement("input");e.type="file",e.webkitdirectory=!0,e.directory=!0,e.multiple=!1,e.addEventListener("change",e=>{const t=e.target.files;if(t.length>0){const e=t[0];if(e.path){const t=e.path.replace(`/${e.name}`,"");this.excelDirPath=t,Fe.Ay.success(`å·²é€‰æ‹©ç›®å½•: ${t}`)}else if(e.webkitRelativePath){const t=e.webkitRelativePath.split("/")[0];this.excelDirPath=t,Fe.Ay.info(`å·²é€‰æ‹©ç›®å½•: ${t}ï¼ˆç›¸å¯¹è·¯å¾„ï¼‰`)}else Fe.Ay.warning("æ— æ³•è·å–å®Œæ•´è·¯å¾„ï¼Œè¯·æ‰‹åŠ¨è¾“å…¥ç›®å½•è·¯å¾„")}}),e.click()},async scanExcelFiles(){if(this.excelDirPath){this.scanning=!0,this.excelFilesScanned=!1,this.scannedExcelFiles=[];try{const e=await G.A.post("/scan/excel",{excel_dir:this.excelDirPath});this.scannedExcelFiles=e.data.excel_files||[],this.excelFilesScanned=!0,this.scannedExcelFiles.length>0?Fe.Ay.success(`æ‰«ææˆåŠŸï¼æ‰¾åˆ° ${this.scannedExcelFiles.length} ä¸ªExcelæ–‡ä»¶`):Fe.Ay.warning("æœªæ‰¾åˆ°Excelæ–‡ä»¶ï¼Œè¯·ç¡®è®¤ç›®å½•è·¯å¾„æ˜¯å¦æ­£ç¡®")}catch(e){console.error("æ‰«æExcelæ–‡ä»¶å¤±è´¥:",e),Fe.Ay.error("æ‰«æExcelæ–‡ä»¶å¤±è´¥ï¼š"+(e.response?.data?.error||e.message)),this.excelFilesScanned=!1}finally{this.scanning=!1}}else Fe.Ay.error("è¯·å…ˆé€‰æ‹©æˆ–è¾“å…¥Excelç›®å½•è·¯å¾„")},async loadResultsFile(){if(this.resultsFilePath){this.uploading=!0,this.resultsFileLoaded=!1;try{const e=await G.A.post("/load/results",{results_path:this.resultsFilePath});this.resultsFileStats={total_records:e.data.total_records||0,categories:e.data.categories||[]},this.resultsFileLoaded=!0,Fe.Ay.success(`æ–‡ä»¶åŠ è½½æˆåŠŸï¼å…± ${this.resultsFileStats.total_records} æ¡è®°å½•`)}catch(e){console.error("åŠ è½½ç»“æœæ–‡ä»¶å¤±è´¥:",e),Fe.Ay.error("åŠ è½½ç»“æœæ–‡ä»¶å¤±è´¥ï¼š"+(e.response?.data?.error||e.message)),this.resultsFileLoaded=!1}finally{this.uploading=!1}}else Fe.Ay.error("è¯·å…ˆè¾“å…¥è¯„æµ‹ç»“æœæ–‡ä»¶è·¯å¾„")},async startAnalysis(){if(this.excelFilesScanned&&this.resultsFileLoaded){this.analyzing=!0;try{await G.A.post("/analysis/start",{excel_dir:this.excelDirPath,results_path:this.resultsFilePath});Fe.Ay.success("æ•°æ®åˆ†æå®Œæˆï¼"),this.visible=!1,this.$emit("uploaded")}catch(e){console.error("æ•°æ®åˆ†æå¤±è´¥:",e),Fe.Ay.error("æ•°æ®åˆ†æå¤±è´¥ï¼š"+(e.response?.data?.error||e.message))}finally{this.analyzing=!1}}else Fe.Ay.error("è¯·å…ˆå®Œæˆæ­¥éª¤1å’Œæ­¥éª¤2")},async clearData(){this.clearing=!0;try{await G.A.delete("/data"),this.resultsFilePath="",this.excelDirPath="./data",this.excelFilesScanned=!1,this.scannedExcelFiles=[],this.resultsFileLoaded=!1,this.resultsFileStats={},Fe.Ay.success("æ•°æ®å·²æ¸…ç©º"),this.$emit("uploaded")}catch(e){console.error("æ¸…ç©ºæ•°æ®å¤±è´¥:",e),Fe.Ay.error("æ¸…ç©ºæ•°æ®å¤±è´¥")}finally{this.clearing=!1}},showDirectoryPicker(){const e=[{label:"å½“å‰ç›®å½• (./)",value:"./"},{label:"dataç›®å½• (./data)",value:"./data"},{label:"excelç›®å½• (./excel)",value:"./excel"},{label:"resultsç›®å½• (./results)",value:"./results"},{label:"ä¸Šçº§dataç›®å½• (../data)",value:"../data"},{label:"ä¸Šçº§excelç›®å½• (../excel)",value:"../excel"},{label:"è‡ªå®šä¹‰è·¯å¾„",value:"custom"}],t=e.map(e=>`<option value="${e.value}">${e.label}</option>`).join(""),l=`\n        <div style="padding: 20px;">\n          <h4>é€‰æ‹©Excelæ•°æ®ç›®å½•</h4>\n          <select id="dir-select" style="width: 100%; padding: 8px; margin: 10px 0; border: 1px solid #d9d9d9; border-radius: 4px;">\n            ${t}\n          </select>\n          <div id="custom-input" style="display: none; margin-top: 10px;">\n            <input type="text" id="custom-dir" placeholder="è¾“å…¥è‡ªå®šä¹‰è·¯å¾„" style="width: 100%; padding: 8px; border: 1px solid #d9d9d9; border-radius: 4px;">\n          </div>\n          <div style="margin-top: 20px; text-align: right;">\n            <button id="cancel-btn" style="margin-right: 10px; padding: 6px 12px; border: 1px solid #d9d9d9; background: white; border-radius: 4px; cursor: pointer;">å–æ¶ˆ</button>\n            <button id="confirm-btn" style="padding: 6px 12px; background: #1890ff; color: white; border: none; border-radius: 4px; cursor: pointer;">ç¡®å®š</button>\n          </div>\n        </div>\n      `,a=document.createElement("div");a.style.cssText="\n        position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n        background: rgba(0,0,0,0.5); z-index: 2000;\n        display: flex; align-items: center; justify-content: center;\n      ",a.innerHTML=l,document.body.appendChild(a);const s=a.querySelector("#dir-select"),i=a.querySelector("#custom-input"),r=a.querySelector("#cancel-btn"),n=a.querySelector("#confirm-btn");s.addEventListener("change",function(){"custom"===this.value?i.style.display="block":i.style.display="none"}),r.addEventListener("click",()=>{document.body.removeChild(a)}),n.addEventListener("click",()=>{let e=s.value;if("custom"===e){const t=a.querySelector("#custom-dir").value.trim();if(!t)return void alert("è¯·è¾“å…¥è‡ªå®šä¹‰è·¯å¾„");e=t}this.excelDirPath=e,document.body.removeChild(a)})},showDirectoryPicker(){const e=[{label:"å½“å‰ç›®å½• (./)",value:"./"},{label:"dataç›®å½• (./data)",value:"./data"},{label:"excelç›®å½• (./excel)",value:"./excel"},{label:"resultsç›®å½• (./results)",value:"./results"},{label:"ä¸Šçº§dataç›®å½• (../data)",value:"../data"},{label:"ä¸Šçº§excelç›®å½• (../excel)",value:"../excel"},{label:"è‡ªå®šä¹‰è·¯å¾„",value:"custom"}],t=e.map(e=>`<option value="${e.value}">${e.label}</option>`).join(""),l=`\n        <div style="padding: 20px;">\n          <h4>é€‰æ‹©Excelæ•°æ®ç›®å½•</h4>\n          <select id="dir-select" style="width: 100%; padding: 8px; margin: 10px 0; border: 1px solid #d9d9d9; border-radius: 4px;">\n            ${t}\n          </select>\n          <div id="custom-input" style="display: none; margin-top: 10px;">\n            <input type="text" id="custom-dir" placeholder="è¾“å…¥è‡ªå®šä¹‰è·¯å¾„ï¼ˆå¦‚ï¼š/Users/username/dataï¼‰" style="width: 100%; padding: 8px; border: 1px solid #d9d9d9; border-radius: 4px;">\n          </div>\n          <div style="margin-top: 20px; text-align: right;">\n            <button id="cancel-btn" style="margin-right: 10px; padding: 6px 12px; border: 1px solid #d9d9d9; background: white; border-radius: 4px; cursor: pointer;">å–æ¶ˆ</button>\n            <button id="confirm-btn" style="padding: 6px 12px; background: #1890ff; color: white; border: none; border-radius: 4px; cursor: pointer;">ç¡®å®š</button>\n          </div>\n        </div>\n      `,a=document.createElement("div");a.style.cssText="\n        position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n        background: rgba(0,0,0,0.5); z-index: 2000;\n        display: flex; align-items: center; justify-content: center;\n      ",a.innerHTML=l,document.body.appendChild(a);const s=a.querySelector("#dir-select"),i=a.querySelector("#custom-input"),r=a.querySelector("#cancel-btn"),n=a.querySelector("#confirm-btn");s.addEventListener("change",function(){"custom"===this.value?i.style.display="block":i.style.display="none"}),r.addEventListener("click",()=>{document.body.removeChild(a)}),n.addEventListener("click",()=>{let e=s.value;if("custom"===e){const t=a.querySelector("#custom-dir").value.trim();if(!t)return void Fe.Ay.error("è¯·è¾“å…¥è‡ªå®šä¹‰è·¯å¾„");e=t}this.excelDirPath=e,Fe.Ay.success("Excelç›®å½•å·²é…ç½®"),document.body.removeChild(a)})},closeModal(){this.visible=!1}}};const Le=(0,x.A)(Ee,[["render",ve],["__scopeId","data-v-4e9b2d44"]]);var we=Le,Ce={name:"App",components:{UploadOutlined:f.A,FileOutlined:de.A,FileTextOutlined:V.A,UploadModal:we},data(){return{uploadModalVisible:!1,configPaths:{excel_dir_path:null,results_file_path:null,excel_files_count:0,results_count:0}}},async created(){await this.loadConfigPaths(),this.$router.afterEach(()=>{this.loadConfigPaths()})},methods:{showUploadModal(){this.uploadModalVisible=!0},handleUploaded(){this.uploadModalVisible=!1,this.loadConfigPaths(),this.$router.go(0)},async loadConfigPaths(){try{const e=await G.A.get("/config/paths");this.configPaths=e.data}catch(e){console.error("åŠ è½½é…ç½®è·¯å¾„å¤±è´¥:",e)}},truncatePath(e){return e?e.length<=40?e:"..."+e.slice(-37):"-"}}};const Se=(0,x.A)(Ce,[["render",ce]]);var Te=Se;l(4529);G.A.defaults.baseURL="/api";const Ae=(0,a.Ef)(Te);Ae.use(s.Ay),Ae.use(ee),Ae.use(ae),Ae.mount("#app")}},t={};function l(a){var s=t[a];if(void 0!==s)return s.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,l),i.exports}l.m=e,function(){var e=[];l.O=function(t,a,s,i){if(!a){var r=1/0;for(d=0;d<e.length;d++){a=e[d][0],s=e[d][1],i=e[d][2];for(var n=!0,o=0;o<a.length;o++)(!1&i||r>=i)&&Object.keys(l.O).every(function(e){return l.O[e](a[o])})?a.splice(o--,1):(n=!1,i<r&&(r=i));if(n){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[a,s,i]}}(),function(){l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,{a:t}),t}}(),function(){l.d=function(e,t){for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};l.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,i,r=a[0],n=a[1],o=a[2],c=0;if(r.some(function(t){return 0!==e[t]})){for(s in n)l.o(n,s)&&(l.m[s]=n[s]);if(o)var d=o(l)}for(t&&t(a);c<r.length;c++)i=r[c],l.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return l.O(d)},a=self["webpackChunkevaluation_viewer_frontend"]=self["webpackChunkevaluation_viewer_frontend"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=l.O(void 0,[504],function(){return l(3755)});a=l.O(a)})();
//# sourceMappingURL=app.d6e81413.js.map